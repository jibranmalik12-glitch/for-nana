<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>For Nana üíñ</title>
  <style>
    :root{
      --bg1:#ffd6e7; --bg2:#fff1f6; --card:#ffffffcc;
      --pink:#ff4d8d; --pink2:#ff79a8; --shadow:0 20px 60px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; overflow:hidden;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(circle at top, var(--bg2), var(--bg1));
      display:flex; align-items:center; justify-content:center;
    }

    .glow{
      position:fixed; inset:-20%;
      background:
        radial-gradient(circle at 20% 20%, rgba(255,77,141,.24), transparent 55%),
        radial-gradient(circle at 80% 30%, rgba(255,121,168,.22), transparent 55%),
        radial-gradient(circle at 60% 85%, rgba(255,77,141,.18), transparent 55%);
      filter: blur(10px); pointer-events:none;
      animation:breathe 6s ease-in-out infinite; opacity:.9;
    }
    @keyframes breathe{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

    .wrap{
      width:min(980px,94vw);
      display:grid; grid-template-columns: 1.05fr .95fr;
      gap:18px; align-items:stretch; position:relative; z-index:2;
    }
    @media(max-width:860px){.wrap{grid-template-columns:1fr}}

    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.75);
      border-radius:22px;
      box-shadow:var(--shadow);
      padding:26px 24px;
      backdrop-filter:blur(10px);
    }

    h1{margin:0 0 10px; color:#b30059; font-size:clamp(26px,3.2vw,40px)}
    .sub{margin:0 0 14px; opacity:.86; line-height:1.55}
    .status{margin:0; opacity:.85; line-height:1.55}

    .names{
      display:inline-flex; gap:10px; align-items:center;
      padding:10px 12px; border-radius:999px;
      background:rgba(255,255,255,.65);
      border:1px solid rgba(255,255,255,.9);
      margin:6px 0 14px;
    }
    .pill{
      padding:6px 10px; border-radius:999px;
      background:linear-gradient(135deg,var(--pink),var(--pink2));
      color:#fff; font-weight:900; font-size:14px;
      box-shadow:0 10px 25px rgba(255,77,141,.25);
    }
    .arrow{opacity:.7}

    .btnRow{display:flex; flex-wrap:wrap; gap:12px; margin-top:14px; justify-content:center}
    button{
      border:0; padding:12px 16px; border-radius:14px;
      font-weight:900; cursor:pointer; font-size:15px;
      transition:transform .14s ease, opacity .14s ease;
      user-select:none;
    }
    .tiny{background:rgba(255,255,255,.65); border:1px solid rgba(255,255,255,.9)}
    .yes{background:linear-gradient(135deg,var(--pink),var(--pink2)); color:#fff; box-shadow:0 16px 30px rgba(255,77,141,.25)}
    .no{background:rgba(0,0,0,.07)}

    .right{display:flex; flex-direction:column; gap:14px}
    .gifBox{
      width:100%; border-radius:18px; overflow:hidden;
      background:rgba(255,255,255,.75);
      border:1px solid rgba(255,255,255,.9);
      box-shadow:0 14px 26px rgba(0,0,0,.08);
      min-height:340px; display:flex; align-items:center; justify-content:center;
      position:relative;
    }
    .gifBox img{width:100%; height:100%; object-fit:cover; display:block}
    .gifCaption{
      position:absolute; bottom:12px; left:12px; right:12px;
      padding:10px 12px; border-radius:14px;
      background:rgba(255,255,255,.78);
      backdrop-filter:blur(8px);
      font-weight:900; font-size:14px;
    }

    .typedWrap{
      display:none;
      margin-top:14px;
      padding:14px;
      border-radius:18px;
      background:rgba(255,255,255,.7);
      border:1px solid rgba(255,255,255,.9);
      box-shadow:0 14px 26px rgba(0,0,0,.06);
      animation:pop .35s ease;
    }
    @keyframes pop{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
    .typed{margin:0; white-space:pre-wrap; line-height:1.7; opacity:.92; text-align:left}
    .cursor{display:inline-block; width:10px; animation:blink 1s step-end infinite}
    @keyframes blink{50%{opacity:0}}

    /* Overlay */
    .overlay{
      position:fixed; inset:0;
      background:rgba(255,214,231,.55);
      backdrop-filter:blur(10px);
      display:flex; align-items:center; justify-content:center;
      z-index:10;
    }
    .envelopeCard{
      width:min(520px,92vw);
      background:rgba(255,255,255,.78);
      border:1px solid rgba(255,255,255,.9);
      border-radius:24px;
      box-shadow:0 25px 80px rgba(0,0,0,.18);
      padding:22px 20px; text-align:center;
    }
    .envelopeTitle{margin:0 0 8px; color:#b30059; font-weight:1000; font-size:20px}
    .envelopeSub{margin:0 0 16px; opacity:.85; line-height:1.55; font-size:14.5px}
    .env{width:210px; height:140px; margin:10px auto 14px; position:relative; cursor:pointer}
    .env .base{
      position:absolute; inset:0;
      background:linear-gradient(135deg,#fff,#ffe6f0);
      border-radius:14px;
      box-shadow:0 18px 40px rgba(255,77,141,.18);
      border:1px solid rgba(255,121,168,.25);
    }
    .env .flap{
      position:absolute; left:0; right:0; top:-2px; height:75px;
      background:linear-gradient(135deg,#ffb3ce,#ff7aa8);
      clip-path:polygon(0 0,100% 0,50% 100%);
      transform-origin:top;
      transition:transform .55s ease;
    }
    .env .seal{
      position:absolute; width:34px; height:34px; border-radius:999px;
      background:radial-gradient(circle at 30% 30%, #fff, #ff79a8);
      left:50%; top:58%; transform:translate(-50%,-50%);
      box-shadow:0 12px 22px rgba(255,77,141,.25);
      border:1px solid rgba(255,255,255,.7);
    }
    .env.open .flap{transform:rotateX(175deg)}

    .startBtn{
      padding:12px 16px; border-radius:14px;
      background:linear-gradient(135deg,var(--pink),var(--pink2));
      color:#fff; font-weight:1000; cursor:pointer;
      box-shadow:0 18px 34px rgba(255,77,141,.25);
    }
    .hint{margin:10px 0 0; font-size:12.5px; opacity:.7}

    /* Hearts */
    .heart{
      position:absolute; width:14px; height:14px; background:var(--pink);
      transform:rotate(45deg); opacity:.25; border-radius:3px;
      animation:floatUp linear forwards; pointer-events:none;
    }
    .heart:before,.heart:after{
      content:""; position:absolute; width:14px; height:14px; background:var(--pink); border-radius:50%;
    }
    .heart:before{left:-7px; top:0}
    .heart:after{top:-7px; left:0}
    @keyframes floatUp{
      0%{transform:translateY(0) rotate(45deg) scale(1);opacity:.15}
      100%{transform:translateY(-120vh) rotate(45deg) scale(1.6);opacity:0}
    }

    /* Confetti */
    .confetti{
      position:fixed; top:-20px; width:10px; height:14px; border-radius:3px; opacity:.9;
      z-index:9; pointer-events:none; animation:confettiFall linear forwards;
    }
    @keyframes confettiFall{to{transform:translateY(120vh) rotate(720deg); opacity:.9}}

    .yesMoment{animation:yesFlash 1.2s ease-in-out}
    @keyframes yesFlash{
      0%{filter:none}
      40%{filter:drop-shadow(0 0 30px rgba(255,77,141,.45)) drop-shadow(0 0 60px rgba(255,121,168,.28))}
      100%{filter:none}
    }
    /* ===== Mobile Optimization ===== */
@media (max-width: 520px){
  body{
    align-items:flex-start;
    padding: 14px 10px 22px;
  }

  .wrap{
    width: 100%;
    grid-template-columns: 1fr;   /* force single column */
    gap: 12px;
  }

  .card{
    padding: 18px 14px;
    border-radius: 18px;
  }

  h1{
    font-size: 24px;
    line-height: 1.15;
  }

  .sub{
    font-size: 14.5px;
  }

  .btnRow{
    gap: 10px;
  }

  /* Buttons fit better on mobile */
  .btnRow button{
    flex: 1;
    min-width: 110px;
    padding: 12px 12px;
    font-size: 14.5px;
  }

  /* GIF area height smaller on mobile */
  .gifBox{
    min-height: 240px;
  }

  .gifCaption{
    font-size: 13px;
    padding: 9px 10px;
  }

  .typed{
    font-size: 14.5px;
  }
}
  </style>
</head>
<body>
  <div class="glow"></div>

  <!-- Overlay -->
  <div class="overlay" id="overlay">
    <div class="envelopeCard">
      <p class="envelopeTitle">A tiny love letter for Nana üíå</p>
      <p class="envelopeSub">
        Tap the envelope (or button) to open it‚Ä¶ and start music üé∂<br/>
        (Offline music file: <b>music.mp3</b>)
      </p>

      <!-- ‚úÖ inline onclick so it always works -->
      <div class="env" id="env" onclick="startExperience()">
        <div class="base"></div>
        <div class="flap"></div>
        <div class="seal"></div>
      </div>

      <button class="startBtn" onclick="startExperience()">Open & Start üíñ</button>
      <p class="hint">Juju ‚Üí Nana </p>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <h1>Nana, will you be my Valentine? üíò</h1>

      <div class="names">
        <span class="pill">Juju</span>
        <span class="arrow">‚áÑ</span>
        <span class="pill">Nana</span>
      </div>

      <p class="sub">I am here to make you feel that you are special üå∏</p>
      <p class="status" id="statusText">Tap ‚ÄúOpen & Start‚Äù first, then choose üòå</p>

      <div class="btnRow">
        <button class="tiny" id="musicBtn">‚ñ∂ Music</button>
        <button class="yes" id="yesBtn">Yes üòò</button>
        <button class="no" id="noBtn">No üôà</button>
      </div>
    </div>

    <div class="right">
      <div class="gifBox" id="gifBox">
        <img id="gifImg" alt="gif" />
        <div class="gifCaption" id="gifCaption">Just‚Ä¶ don‚Äôt make me too nervous üò≥</div>
      </div>

      <div class="typedWrap" id="typedWrap">
        <p class="typed" id="typedText"></p><span class="cursor" id="cursor">|</span>
      </div>

      <div class="card">
        <p class="status" style="margin:0;">pure heart, pure love, pure soul. Nana ‚Äî this is only for you. üíó</p>
      </div>
    </div>
  </div>

  <!-- ‚úÖ OFFLINE MUSIC -->
  <audio id="bgMusic" preload="auto" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ====== LOCAL GIFS ======
    const gifs = {
      initial: { url: "initial.gif", caption: "Say yes‚Ä¶ softly üò≥" },
      sad: [
        { url: "sad1.gif", caption: "Oh no‚Ä¶ my heart üíî" },
        { url: "sad2.gif", caption: "Nana please‚Ä¶ ü•∫" },
        { url: "sad3.gif", caption: "It‚Äôs getting sadder‚Ä¶ üò¢" },
        { url: "sad4.gif", caption: "Okay‚Ä¶ I‚Äôm officially broken üò≠" }
      ],
      kiss: { url: "kiss.gif", caption: "Yayyyyyy, You said Yes my Princess üíã" }
    };

    const overlay = document.getElementById("overlay");
    const env = document.getElementById("env");
    const statusText = document.getElementById("statusText");

    const gifImg = document.getElementById("gifImg");
    const gifCaption = document.getElementById("gifCaption");
    const gifBox = document.getElementById("gifBox");

    const music = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");

    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");

    const typedWrap = document.getElementById("typedWrap");
    const typedText = document.getElementById("typedText");
    const cursor = document.getElementById("cursor");

    let started = false;
    let musicPlaying = false;
    let noCount = 0;
    let yesScale = 1;
    let typingTimer = null;

    function setGif(obj){
      gifImg.src = obj.url;
      gifCaption.textContent = obj.caption;
    }
    setGif(gifs.initial);

    // ‚úÖ THIS is the function your overlay calls
    function startExperience(){
      if(started) return;
      started = true;

      env.classList.add("open");

      // Always hide overlay even if music fails
      overlay.style.display = "none";
      statusText.textContent = "Welcome, Nana üíó Now choose‚Ä¶";

      // Try to start music (if it fails, user can press Music button)
      music.play().then(()=>{
        musicPlaying = true;
        musicBtn.textContent = "‚è∏ Music";
      }).catch(()=>{
        statusText.textContent = "Tap ‚ñ∂ Music (some browsers block auto-play) üé∂";
      });
    }

    function toggleMusic(){
      if(!musicPlaying){
        music.play().then(()=>{
          musicPlaying = true;
          musicBtn.textContent = "‚è∏ Music";
        }).catch(()=>{
          statusText.textContent = "Music didn‚Äôt start ‚Äî check music.mp3 file üîä";
        });
      }else{
        music.pause();
        musicPlaying = false;
        musicBtn.textContent = "‚ñ∂ Music";
      }
    }
    musicBtn.addEventListener("click", toggleMusic);

    // Hearts
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const size = 10 + Math.random()*18;
      h.style.width = size + "px";
      h.style.height = size + "px";
      h.style.left = Math.random()*100 + "vw";
      h.style.bottom = "-20px";
      const duration = 4 + Math.random()*5;
      h.style.animationDuration = duration + "s";
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), duration*1000);
    }
    setInterval(spawnHeart, 260);

    function runAway(el){
      const dx = (Math.random()*220) - 110;
      const dy = (Math.random()*140) - 70;
      el.style.transform = `translate(${dx}px, ${dy}px)`;
      setTimeout(()=> el.style.transform = "", 240);
    }

    noBtn.addEventListener("click", () => {
      noCount++;
      const idx = Math.min(noCount-1, gifs.sad.length-1);
      setGif(gifs.sad[idx]);

      const lines = ["Are you sure, Nana? üôà","Please‚Ä¶ don‚Äôt break me ü•∫","I‚Äôm getting sadder üò¢","Okay‚Ä¶ last try üò≠"];
      statusText.textContent = lines[idx] || "Please say yes ü•∫";

      yesScale = 1 + Math.min(noCount*0.10, 0.55);
      yesBtn.style.transform = `scale(${yesScale})`;

      runAway(noBtn);
    });

    function confettiBurst(){
      for(let i=0;i<70;i++){
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random()*100 + "vw";
        c.style.animationDuration = (2.6 + Math.random()*2.2) + "s";
        c.style.transform = `rotate(${Math.random()*360}deg)`;
        c.style.background = `hsl(${Math.floor(Math.random()*360)}, 85%, 65%)`;
        document.body.appendChild(c);
        setTimeout(()=> c.remove(), 5200);
      }
    }

    function typeMessage(text){
      clearInterval(typingTimer);
      typedText.textContent = "";
      typedWrap.style.display = "block";
      cursor.style.display = "inline-block";

      let i = 0;
      typingTimer = setInterval(() => {
        typedText.textContent += text[i];
        i++;
        if(i >= text.length){
          clearInterval(typingTimer);
          cursor.style.display = "none";
        }
      }, 22);
    }

    yesBtn.addEventListener("click", () => {
      setGif(gifs.kiss);
      statusText.textContent = "You said YES! üòç";
      gifBox.classList.add("yesMoment");
      setTimeout(()=> gifBox.classList.remove("yesMoment"), 1300);
      confettiBurst();

      if(!musicPlaying){
        music.play().then(()=>{
          musicPlaying = true;
          musicBtn.textContent = "‚è∏ Music";
        }).catch(()=>{});
      }

      const msg =
`Nana‚Ä¶ üíû

If love had a calm sound, it would feel like you.
If comfort had a face, it would be yours.

Thank you for being my softness,
my peace,
my favorite place to return to.

Happy Valentine‚Äôs Day, my Nana.

‚Äî Juju ‚ù§Ô∏è`;

      typeMessage(msg);

      yesBtn.disabled = true;
      noBtn.disabled = true;
      noBtn.style.opacity = ".55";
    });
  </script>
</body>
</html>

